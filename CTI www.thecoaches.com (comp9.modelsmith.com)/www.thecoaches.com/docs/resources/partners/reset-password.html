<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>CTI</title>
<meta http-equiv="Content-type" content="text/html; charset=UTF-8" />
<meta http-equiv="Content-Language" content="en" />
<meta name="language" content="en" />
<meta name="keywords" content="coach training, leadership training, organizational coach training, co-active, become a coach, training coaching, coach certification, coaching certification, coach training, coaching as a career, transformational learning, in person training, face to face training, mentoring, business coaching, business transformation, personal transformation, worldwide coaching, change career, improve career, help people, people to people, active listening, Henry Kimsey-House, Karen Kimsey-House, CPCC, Co-Active Coaching, co-Active model, co-Active Leadership" />
<meta name="description" content="CTI, The Coaches Training Institute trains more coaches around the world than any other training group. Using our Co-Active model, we helped establish the coach training industry and were a founder of the ICF. Through our coach training, you can become an ICF certified coach. Through our Leadership training, you can raise your leadership skills to new and unexpected heights. Our Organizational training helps companies train their managers to get the most out of happy employees." />
<meta name="author" content="The Coaches Training Institute (CTI)" />
<meta name="copyright" content="Copyright &#169; 2009 The Coaches Training Institute. All rights reserved." />
<meta name="nullbot" content="noarchive,nosnippet" />
<link rel="icon" href="/favicon.ico" />
<link rel="shortcut icon" href="/favicon.ico" />
<link rel="stylesheet" type="text/css" href="/res/css/coaches-training-institute.css" />
<link rel="stylesheet" type="text/css" href="/res/css/section_general.css" />
<link rel="stylesheet" type="text/css" href="/res/css/content_internal_11.css" />
<link rel="stylesheet" type="text/css" href="/res/css/mentor.css" />
<script type="text/javascript" src="/res/js/coaches-training-institute.js"> </script>
    
    <link rel="stylesheet" type="text/css" href="/res/css/home-footer.css" />
	<script type="text/javascript" src="/res/js/coaches-training-institute.js"> </script>
    <script type="text/javascript" src="http://www.google.com/jsapi"></script>
	<script type="text/javascript" src="/res/js/specials.js"> </script>
	<script type="text/javascript" src="/res/js/jquery-1.4.2.min.js"></script>
	<script type="text/javascript" src="/res/js/jquery.expire.js"> </script>
	<script language="JavaScript" type="text/javascript">
	var html = '';
	var count = 0;
	google.setOnLoadCallback(function(){
	jQuery.contentExpirator('expire');
	$.get('/blog/feed/', function(xml){
	        $("item", xml).each(function(){
	                count++;
	                if(count > 3) return false;
	                $(this).find("link").each(function(){
	                        html += "<div class='blog-entry'><strong><a href='" + getNodeText(this) +"'> ";
	                }).end().find("title").each(function(){
	                        html += getNodeText(this) + "</a></strong>";
	                }).end().find("description").each(function(){
	                        html += "<p style='font-size: 12px;'>" + getNodeText(this).substring(0, 150) +" [â€¦]<br />";
	                }).end().find("link").each(function(){
	                        html += "<a href='" +getNodeText(this) + "'>Continue reading &raquo;</a></p></div>";
	                });
	        });
	        $("#home-news").html(html);
	});
	});
	
	function getNodeText(node)
	{
	        var text = "";
	        if(node.text) text = node.text;
	        if(node.firstChild) text = node.firstChild.nodeValue;
	        return text;
	}
	</script>

</head>

<body>

<script type="text/javascript">

var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");

document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));

</script>

<script type="text/javascript">

try {

var pageTracker = _gat._getTracker("UA-5715102-1");

pageTracker._trackPageview();

} catch(err) {}</script>



<div id="page">

<div id="tools">

  <!-- generalID --><& '/res/inc/id_general.html' &><!-- -->

  <!-- eCommerceID --><& '/res/inc/id_ecommerce.html' &><!-- -->

</div>

<div id="primary">

  <!-- contactNavID --><& '/res/inc/id_contact-nav.html' &><!-- -->

  <ul id="main-nav">

    <li><a href="/why-coaches-training-institute/">Why <abbr title="Coaches Training Institute">CTI</abbr>?</a></li>

    <li><a href="/coach-training/">Coach Training</a></li>

    <li><a href="/leadership/">Leadership</a></li>

    <li><a href="/organizations/">For Organizations</a></li>

    <li><a href="/leaders/">Our Faculty</a></li>

    <li><a href="/resources/">Resources</a></li>

    <li style="float:right; margin: 0; padding:0; position: absolute; top: 73px; padding-left: 30px;"><a href="/"><img src="/res/img/brand_coactive.png" height="34" width="175" /></a></li>
</ul>

  

<div id="broadcast">

  <img src="/res/img/page-banners/content_general.gif" width="920" height="124" alt="Why Coaches Training Institute?" usemap="#logobutton" />

  <map id="logobutton" name="logobutton">

  <area shape="rect" coords="822,0,899,103" href="/" title="CTI Home" alt="CTI Home" />

  </map>

</div>

<!--<div id="sub-nav">

  <ul id="section-nav">

    <li class="current"><a href="/contact/">Contact Us</a></li>

    <li><a href="/contact/schedule-a-call/">Contact a Program Advisor</a></li>

    <li><a href="/contact/conference/">Live Teleconference</a></li>

  </ul>

</div>-->



<div id="content">

<div id="main">

  

<div id="breadcrumbs">

  <p><span id="youarehere" class="accessibility-hide">You are here:&#160;</span> <a href="/">Home</a><span class="divider">&#160;||&#160;</span><a href="/contact/" class="here">Policies</a></p>

</div>










<div class="pri">

% if($key_ok == 1){
<h1 id="main-headline">Please enter your new password</h1>
 <form action="reset-password.html" method="POST">
   <input type="hidden" name="pkey" value="<% $k %>">
     <table>
    <tr>
  <th><label for="signin_username">Email address</label></th>
  <td><% $email %></td>
</tr>
<tr>
  <th><label for="signin_password">Password</label></th>
  <td><input type="password" name="password" id="signin_password" /></td>
</tr>
<tr>
  <th><label for="signin_password">Verify</label></th>
  <td><input type="password" name="verify" id="signin_verify" /></td>
</tr>
  <tr><td></td><td>
  <input type="submit" value="Save New Password" />
  </td></tr>
  </table>

</form>
% } elsif($key_ok == 2) {
<h1 id="main-headline">Thank you!</h1>

<p>Your new password has been saved. Please <a href="login.html">sign in</a>.
% } else {
<h1 id="main-headline">Try Again</h1>
  <p>Invalid reset key. Please <a href="reset-password-request.html">try again</a>.
% }
 
<!--
  <% Dumper {url => $url, result => $result} %>
 -->




</div>
</div>

<div id="sidebar">

  

<div class="pri">

  <img src="/res/img/testimonial_pics/small/corrina_0K2J4683.gif" width="228" height="114" alt="Corrina Gordon-Barnes" />

  <blockquote>

  <p>&quot;I love creating space for people to create a vision of who they really are, at their most powerful. And what they want to do at their most powerful.&quot;</p>

  <cite>Corrina Gordon-Barnes</cite><span class="accessibility-hide">, </span>

  <span class="normtext"><abbr title="Coaches Training Institute">Co-active Coach</abbr><br>Cambridge, England</span>

  </blockquote>

</div>



</div>

</div>



     <!-- ctaAreaId --><!-- & '/res/inc/id_cta-area.html' & --><!-- -->
        
        <!-- used for cross-browser stabilizion of layout -->
        <div class="pageclear"></div>
      <!-- /div -->
  	 </div>


	<!-- ctaAreaId --><& '/res/inc/id_tabbed-footer-1.html' &><!-- -->
<script type="text/javascript" src="http://twitter.com/javascripts/blogger.js"></script>
<script type="text/javascript" src="http://twitter.com/statuses/user_timeline/cti_coaches.json?callback=twitterCallback2&amp;count=4"></script>
<script type="text/javascript">
	// Enable footer tab functionality
	(function($) {
		$('#footerMain .tabs a').click(function(event) {
			// Prevent default click behavior
			// ev.preventDefault();
			event.preventDefault();

			// Set up some variables and grab some resuable DOM references
			var $t = $(this), // Quick ref for the clicked link
				$fm = $('#footerMain').eq(0), // Quick ref for the containing footer div
				id = $t.attr('href').split('#')[1], // Get the id out of this link's href
				visName = $('.panel:visible', $fm).get(0).id.substr(6), // Get the name of the currently showing panel (Tuck, Centers, Corporate)
				tgtName = id.substr(6); // Get the name of the target panel to show, like above
		
			$('.tabs', $fm).removeClass('active'+visName).addClass('active'+tgtName); // Change indicator class for proper tab styling
			$('.panel', $fm).hide().siblings('#'+id).show(); // Swap which panel is visible
		});

	})(jQuery);
</script>

</body>

</html>
<%once>
 use CTI::Secret;
 use Digest::SHA1;
 use URI::Escape;
</%once>
<%init>
my $args = $m->request_args();

my ($k) = @{$args}{'k'};
$k =~ s/[^A-Za-z0-9]//gms; #untaint k

my ($pkey) = @{$args}{'pkey'};
$pkey =~ s/[^A-Za-z0-9]//gms; #untaint k

my ($password) = @{$args}{'password'};
$password = substr($password, 0, 32); #limit to 32 characters

my ($verify) = @{$args}{'verify'};
$password = substr($password, 0, 32); #limit to 32 characters


my $err    = '';
my $url    = '';
my $result = '';
my $email  = '';
my $key_ok = 0;

if($k ne ''){
  ($email) = $dbh->selectrow_array('SELECT username FROM auth_users WHERE passwd=? AND ((current_timestamp()-ts)<1000000) LIMIT 1',undef,$k); # must be not older than one day

  if($email ne ''){
    $pkey = $k;
    $key_ok = 1;
  }

}

elsif ($pkey && $password ne '' && $verify eq $password) {
  # check pkey

  ($email) = $dbh->selectrow_array('SELECT username FROM auth_users WHERE passwd=? AND ((current_timestamp()-ts)<1000000) LIMIT 1',undef,$pkey); # must be not older than one day

  if($email ne ''){
    # remove key
    my $text = "bcdfghjkmnpqrstvwxyzABCDEFGHJKLMNPRSTUVWXYZ23456789";
    my $length = int(rand() * 2) + 14;
    my $x = 0;
    my $key = "";
    while ($x<$length) {
      my $ranNo = int(rand() * length($text));
      my $a = substr($text, $ranNo, 1);
      $key .= $a; $x++;
    }
    $dbh->do('UPDATE auth_users SET passwd=? WHERE username=?',undef,$key,$email);
    
    my $em = uri_escape( $email,    '^A-Za-z0-9@.-_' );
    my $pw = uri_escape( $password, '^A-Za-z0-9@.-_' );
    $url = "http://webcomp.modelsmith.com/fmi-test/webcomp2_newFM/set_pw.php?postkey=fjgh12fgt&em=$em&pw=$pw";
    $result = `/usr/bin/curl '$url'`;
     if ($result eq 'ok') {
    $key_ok = 2;
     }
  }
}

</%init>
