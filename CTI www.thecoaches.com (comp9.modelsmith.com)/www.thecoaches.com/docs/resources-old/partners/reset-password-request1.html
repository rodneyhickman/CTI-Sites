<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>CTI</title>
<meta http-equiv="Content-type" content="text/html; charset=UTF-8" />
<meta http-equiv="Content-Language" content="en" />
<meta name="language" content="en" />
<meta name="keywords" content="coach training, leadership training, organizational coach training, co-active, become a coach, training coaching, coach certification, coaching certification, coach training, coaching as a career, transformational learning, in person training, face to face training, mentoring, business coaching, business transformation, personal transformation, worldwide coaching, change career, improve career, help people, people to people, active listening, Henry Kimsey-House, Karen Kimsey-House, CPCC, Co-Active Coaching, co-Active model, co-Active Leadership" />
<meta name="description" content="CTI, The Coaches Training Institute trains more coaches around the world than any other training group. Using our Co-Active model, we helped establish the coach training industry and were a founder of the ICF. Through our coach training, you can become an ICF certified coach. Through our Leadership training, you can raise your leadership skills to new and unexpected heights. Our Organizational training helps companies train their managers to get the most out of happy employees." />
<meta name="author" content="The Coaches Training Institute (CTI)" />
<meta name="copyright" content="Copyright &#169; 2009 The Coaches Training Institute. All rights reserved." />
<meta name="nullbot" content="noarchive,nosnippet" />
<link rel="icon" href="/favicon.ico" />
<link rel="shortcut icon" href="/favicon.ico" />
<link rel="stylesheet" type="text/css" href="/res/css/coaches-training-institute.css" />
<link rel="stylesheet" type="text/css" href="/res/css/section_general.css" />
<link rel="stylesheet" type="text/css" href="/res/css/content_internal_11.css" />
<link rel="stylesheet" type="text/css" href="/res/css/mentor.css" />
<script type="text/javascript" src="/res/js/coaches-training-institute.js"> </script>
</head>

<body>

<script type="text/javascript">

var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");

document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));

</script>

<script type="text/javascript">

try {

var pageTracker = _gat._getTracker("UA-5715102-1");

pageTracker._trackPageview();

} catch(err) {}</script>



<div id="page">

<div id="tools">

  <!-- generalID --><& '/res/inc/id_general.html' &><!-- -->

  <!-- eCommerceID --><& '/res/inc/id_ecommerce.html' &><!-- -->

</div>

<div id="primary">

  <!-- contactNavID --><& '/res/inc/id_contact-nav.html' &><!-- -->

  <ul id="main-nav">

    <li><a href="/why-coaches-training-institute/">Why <abbr title="Coaches Training Institute">CTI</abbr>?</a></li>

    <li><a href="/coach-training/">Coach Training</a></li>

    <li><a href="/leadership/">Leadership</a></li>

    <li><a href="/organizations/">For Organizations</a></li>

    <li><a href="/leaders/">Our Faculty</a></li>

    <li><a href="/resources/">Resources</a></li>

  </ul>

  

<div id="broadcast">

  <img src="/res/img/page-banners/content_general.gif" width="920" height="124" alt="Why Coaches Training Institute?" usemap="#logobutton" />

  <map id="logobutton" name="logobutton">

  <area shape="rect" coords="822,0,899,103" href="/" title="CTI Home" alt="CTI Home" />

  </map>

</div>

<!--<div id="sub-nav">

  <ul id="section-nav">

    <li class="current"><a href="/contact/">Contact Us</a></li>

    <li><a href="/contact/schedule-a-call/">Contact a Program Advisor</a></li>

    <li><a href="/contact/conference/">Live Teleconference</a></li>

  </ul>

</div>-->



<div id="content">

<div id="main">

  

<div id="breadcrumbs">

  <p><span id="youarehere" class="accessibility-hide">You are here:&#160;</span> <a href="/">Home</a><span class="divider">&#160;||&#160;</span><a href="/contact/" class="here">Policies</a></p>

</div>



<h1 id="main-headline">Enter your email address to request a new password</h1>







<div class="pri">

% if($request_ok == 1){
 <p>You will receive an email with instructions to reset your password.</p>
% } elsif($request_ok == -1){
 <p>We were not able to find your email address in our database. Please contact us at 1-800-691-6008. Thank you. </p>
% } else {
 <form action="reset-password-request.html" method="POST">
     <table>
    <tr>
  <th><label for="signin_username">Email address</label></th>
  <td><input type="text" name="email" id="signin_username" /></td>
</tr>

  <tr><td></td><td>
  <input type="submit" value="Request Password Reset" />
  </td></tr>

  </table>

</form>
% }
 
%# <% Dumper {values => \%values, err => $err, url => $url, result => $result, email => $email, date => `date`, } %>
 




</div>
</div>

<div id="sidebar">

  

<div class="pri">

  <img src="/res/img/testimonial_pics/small/corrina_0K2J4683.gif" width="228" height="114" alt="Corrina Gordon-Barnes" />

  <blockquote>

  <p>&quot;I love creating space for people to create a vision of who they really are, at their most powerful. And what they want to do at their most powerful.&quot;</p>

  <cite>Corrina Gordon-Barnes</cite><span class="accessibility-hide">, </span>

  <span class="normtext"><abbr title="Coaches Training Institute">Co-active Coach</abbr><br>Cambridge, England</span>

  </blockquote>

</div>



</div>

</div>



<!-- ctaAreaId --><& '/res/inc/id_cta-area.html' &><!-- -->



<!-- used for cross-browser stabilizion of layout -->

<div class="pageclear"></div>



</div>



<div id="footer">

  <img id="cti-logo-tagged" src="/res/img/cti-changing-business-transforming-lives.gif" width="176" height="57" alt="cit: changing business. transforming lives."/>

<div id="footer-content">

  <!-- footerNavId --><& '/res/inc/id_footer-nav.html' &><!-- -->

  <img id="icf-logo" src="/res/img/icf-logo.gif" width="74" height="57" alt="International Coach Federation"/>

</div>



</div>

</div>

</body>

</html>
<%once>
 use CTI::Secret;
 use Digest::SHA1;
 use URI::Escape;
 use Mail::Sendmail qw(sendmail);
</%once>
<%init>
my $args       = $m->request_args();

my ($email)    = @{$args}{'email'};
$email =~ s/[^A-Za-z0-9\@\_\-\.]//gms; #untaint email address

my $err        = '';
my $url        = '';
my $result     = '';
my %values;
my $request_ok = 0;

if ($email) {
  # check email address in database

  my $em = uri_escape( $email,    '^A-Za-z0-9@.-_' );

  $url = "http://webcomp.modelsmith.com/fmi-test/webcomp/lookup.php?postkey=fjgh15t&em=$em";
  $result = `/usr/bin/curl '$url'`;

  if($result eq 'ok'){
    # create unique key
    my $text = "bcdfghjkmnpqrstvwxyzABCDEFGHJKLMNPRSTUVWXYZ23456789";
    my $length = int(rand() * 2) + 14;
    my $x = 0;
    my $key = "";
    while ($x<$length) {
      my $ranNo = int(rand() * length($text));
      my $a = substr($text, $ranNo, 1);
      $key .= $a; $x++;
    }

    # save in local database (auth_users table)
    my ($id) = $dbh->selectrow_array('SELECT id FROM auth_users WHERE username=?',undef,$email);

    if ($id > 0) {
      $dbh->do('UPDATE auth_users SET passwd=? WHERE id=?',undef,$key,$id);
    } else {
      $dbh->do('INSERT INTO auth_users (username,passwd) values (?,?)',undef,$email,$key);
    }
    # send email

my $MAIL = qq{We have received your request for a password reset. Please click the
following link to continue. If you did not make this request, please
disregard and delete this email.

http://www.thecoaches.com/student/reset-password.html?k=$key

The Coaches Training Institute
1-800-691-6008
};

my %mail = (   To      => $email,
            From    => 'registration@thecoaches.com',
            Subject =>  "Subject: CTI Password Reset Request",
            Message => $MAIL,
           );

sendmail(%mail);

#    my $mailprog = '/usr/lib/sendmail -i -t -f info@thecoaches.com';
#    open(MAIL,"|$mailprog");
#    print MAIL "From: The Coaches Training Institute <info\@thecoaches.com>\n";
#    print MAIL "To: $email\n";
#    print MAIL "Subject: CTI Password Reset Request\n\n";
#    print MAIL $MAIL;
#    close(MAIL);


    $request_ok = 1;
  } else {
    $request_ok = -1;  
  }
}

</%init>
