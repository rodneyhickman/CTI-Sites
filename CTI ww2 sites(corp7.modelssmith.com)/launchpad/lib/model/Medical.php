<?php

require 'lib/model/om/BaseMedical.php';


/**
 * Skeleton subclass for representing a row from the 'medical' table.
 *
 * 
 *
 * This class was autogenerated by Propel 1.4.2 on:
 *
 * Wed Apr 13 02:34:42 2011
 *
 * You should add additional methods to this class to meet the
 * application requirements.  This class will only be generated as
 * long as it does not already exist in the output directory.
 *
 * @package    lib.model
 */
class Medical extends BaseMedical {

  // Private
  var $xtea;

  public function setXTEA( $ref ){
    $this->xtea = $ref;
  }


  // Example encryption setter and getter

  // public function setExtra1_( $value ){
  //   $this->setExtra1( $this->xtea->encrypt( $value ));
  //   $this->save();
  // }

  // public function getExtra1_(){
  //   return $this->xtea->decrypt( $this->getExtra1() );
  // }

  // convert underscored getters and setters to regular getters and setters

  // see http://www.beutelevision.com/edit/wiki.pl?SymfonyExamples/ModelExtraAttributes

  public function __call($name, $arguments) {
    // Note: value of $name is case sensitive.
    // Medical.php getXXX_ function (the underscore indicates that it is the encrypted version. I couldn't think of something more clever.)
    if( preg_match('/^get(.*)_/', $name, $matches) ){
      $field = $matches[1];
      eval("\$value = \$this->get".$field."();"); 
      $decrypted_value = $this->xtea->decrypt( $value );
      $decrypted_value = preg_replace("/^$field/",'',$decrypted_value);
      return trim($decrypted_value); // trim leading and following whitespace
    }
    // Medical.php setXXX function
    else if( preg_match('/^set(.*)_/', $name, $matches) ){
      $field           = $matches[1];
      $encrypted_value = $this->xtea->encrypt( $field . $arguments[0] );
      eval("\$this->set".$field."(\$encrypted_value);");
      $this->save();
    }
    else {  // fatal error if function name does not contain "get" or "set"
      exit("lib/model/Medical.php error: $name function not found");
    }
  }

} // Medical


//Eval example from Profile.php: eval("\$text = \$this->get".$table_field."();");